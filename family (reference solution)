def height(man):
    if man not in p_tree:
        return 0
    else:
        return 1 + height(p_tree[man]) # Опускаемся к родителю: на один уровень ниже (по словарю): если ключ - "Peter_III" (ребенок), то значение (p_tree[man]) - "Anna" (родитель)
 
p_tree = {}
n = int(input())
for i in range(n - 1):
    child, parent = input().split()
    p_tree[child] = parent

heights = {}
for man in set(p_tree.keys()).union(set(p_tree.values())): # собираем всех родственников
    heights[man] = height(man)

for key, value in sorted(heights.items()):
    print(key, value)
